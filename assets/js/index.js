// Generated by CoffeeScript 1.8.0
(function() {
  var addKey, audioCtx, createCheat, loadSound, playSound, removeKeys, soundBuffers;

  addKey = function(key) {
    return $('.keys').append("<div class=\"key\"> " + key + " </div>").removeClass('hidden');
  };

  removeKeys = function() {
    $('.keys').find('.key').addClass('bye');
    return setTimeout(function() {
      return $('.keys').addClass('hidden').empty();
    }, 300);
  };

  createCheat = function(cheatStr, done) {
    return cheet(cheatStr, {
      next: function(str, key, num, seq) {
        return addKey(key);
      },
      fail: function() {
        return removeKeys();
      },
      done: function() {
        done();
        return setTimeout(function() {
          return removeKeys();
        }, 1000);
      }
    });
  };

  createCheat('↑ ↑ ↓ ↓ ← → ← → b a', function() {
    return alert('Voilà!');
  });

  createCheat('f i l l space d e space p u t a', function() {
    return alert('Com goses insultarme? Fill de meuca, al infern aniràs...');
  });

  createCheat('a r o u n d space t h e space w o r l d', function() {
    return playSound('atw');
  });

  window.soundBuffers = soundBuffers = {};

  window.audioCtx = audioCtx = new AudioContext();

  loadSound = function(name, snd) {
    var request;
    request = new XMLHttpRequest();
    request.open('GET', snd);
    request.responseType = 'arraybuffer';
    request.onload = function(e) {
      return audioCtx.decodeAudioData(request.response, function(buffer) {
        return soundBuffers[name] = buffer;
      });
    };
    request.onerror = function(e) {
      return window.alert(e);
    };
    return request.send();
  };

  playSound = function(name) {
    var buffer, source;
    buffer = soundBuffers[name];
    if (!buffer) {
      return window.alert('Buffer is null or undefined');
    } else {
      source = audioCtx.createBufferSource();
      source.buffer = buffer;
      source.connect(audioCtx.destination);
      return setTimeout(function() {
        return source.start(0);
      }, 100);
    }
  };

  loadSound('atw', 'assets/snd/atw.ogg');

}).call(this);
